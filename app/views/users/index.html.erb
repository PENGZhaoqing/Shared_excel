<div class="container">
  <div class="row">
    <div class="col-sm-3 col-md-3">
      <%= render "users/sidenav" %>

    </div>
    <div class="col-sm-9 col-md-9">
      <div class="panel panel-default">
        <div class="panel-heading">
          <h3 class="panel-title">控制面板</h3>
        </div>
        <div class="panel-body" style="min-height: 450px">
          <h4 class="text-muted">用户管理</h4>
          <hr>
          <%= link_to "新增用户", users_path(new_user: true), class: 'btn-sm btn-success pull-right' %>

          <table class="table table-striped table-hover">
            <thead>
            <tr>
              <th>姓名</th>
              <th>公司</th>
              <th>角色</th>
              <th>注册时间</th>
              <th></th>

            </tr>
            </thead>
            <tbody>
            <% @users.each do |user| %>
                <tr>
                  <td><%= user.name %></td>
                  <td><%= user.company %></td>
                  <% if user.admin %>
                      <td>管理员</td>
                  <% else %>
                      <td>普通</td>
                  <% end %>
                  <td><%= user.created_at.strftime("%Y/%m/%d %H:%M") %></td>

                  <% if !params[:users_page].blank? %>
                      <td><%= link_to "编辑", users_path(user_id: user.id, users_page: params[:users_page].to_i), class: 'btn-sm btn-info' %></td>
                  <% else %>
                      <td><%= link_to "编辑", users_path(user_id: user.id), class: 'btn-sm btn-info' %></td>
                  <% end %>
                  <td><%= link_to "删除", user_path(user), method: :delete, class: 'btn-sm btn-danger' %></td>

                </tr>
            <% end %>
            </tbody>
          </table>

          <%= will_paginate @new_users, :param_name => 'users_page',
                            :previous_label => t("前一页"), :next_label => t("后一页"), :inner_window => 1 %>

          <hr>

          <% if params[:new_user]=='true' %>
              <%= render 'new_user' %>
          <% elsif !params[:user_id].blank? &&!@user.nil? %>
              <%= render 'edit_user' %>
          <% end %>

        </div>
      </div>
    </div>
  </div>
</div>


